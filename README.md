# Lighter DEX Market Maker

This project is a complete market making solution for the Lighter DEX, built in Python. It consists of three main components that work together to collect data, calculate optimal trading parameters, and execute a market making strategy.

The three core components are:
1.  **Data Collector (`gather_lighter_data.py`)**: Connects to the Lighter DEX websocket to stream real-time order book and trade data, saving it to CSV files.
2.  **Parameter Calculator (`calculate_avellaneda_parameters.py`)**: Implements the Avellaneda-Stoikov model to calculate optimal bid/ask spreads and reservation prices based on the collected data.
3.  **Market Maker (`market_maker.py`)**: Executes the market making strategy by placing and managing orders on the Lighter exchange, using the parameters generated by the calculator.

The entire system is orchestrated using Docker Compose, making it easy to run and manage.

## Quick Start

### Prerequisites
*   Docker
*   Docker Compose

### 1. Configuration

Create a `.env` file in the root of the project with the following content:

```
API_KEY_PRIVATE_KEY=<your_api_key_private_key>
ACCOUNT_INDEX=<your_account_index>
API_KEY_INDEX=<your_api_key_index>
```

You can obtain these credentials from the Lighter exchange.

### 2. Running the Bot

Start all services using Docker Compose:
```bash
docker-compose up -d
```

This will start the data collector, parameter calculator, and market maker in the background.

### 3. Monitoring

You can monitor the logs of each service using the following commands:

*   **Data Collector**: `docker-compose logs -f lighter-data-collector`
*   **Parameter Calculator**: `docker-compose logs -f avellaneda-calculator`
*   **Market Maker**: `docker-compose logs -f market_maker`

### 4. Stopping the Bot

To stop all services, run:
```bash
docker-compose down
```

## Project Structure

```
.
├── docker-compose.yml
├── Dockerfile
├── gather_lighter_data.py
├── calculate_avellaneda_parameters.py
├── market_maker.py
├── requirements.txt
├── .env.example
├── lighter_data/       # CSV output data
└── logs/               # Log files
```

## How it Works

### 1. Data Collection

The `gather_lighter_data.py` script connects to the Lighter DEX websocket and subscribes to the order book and trade channels for the configured markets (e.g., 'ETH', 'BTC', 'PAXG'). It saves this data to CSV files in the `lighter_data` directory.

### 2. Parameter Calculation

The `calculate_avellaneda_parameters.py` script runs periodically (as defined in `docker-compose.yml`). It reads the data collected by the `gather_lighter_data.py` script and uses it to calculate the parameters for the Avellaneda-Stoikov market making model. The calculated parameters are saved to a JSON file (e.g., `avellaneda_parameters_PAXG.json`).

### 3. Market Making

The `market_maker.py` script reads the parameters from the JSON file generated by the calculator. It then connects to the Lighter exchange and places buy and sell orders based on the calculated optimal spreads and reservation prices. It continuously monitors the market and its own orders, adjusting them as needed.

## Development

### Local Development

If you want to run the scripts locally without Docker, you can follow these steps:

1.  **Install dependencies**: `pip install -r requirements.txt`
2.  **Run the scripts**:
    *   `python gather_lighter_data.py`
    *   `python calculate_avellaneda_parameters.py`
    *   `python market_maker.py`

Make sure to have a `.env` file with the required API credentials in the root of the project.